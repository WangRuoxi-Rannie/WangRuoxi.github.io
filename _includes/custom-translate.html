<!-- Google翻译脚本 -->
<script type="text/javascript">
  function googleTranslateElementInit() {
    new google.translate.TranslateElement(
      {
        pageLanguage: 'zh-CN',
        includedLanguages: 'en,zh-CN',
        layout: google.translate.TranslateElement.InlineLayout.SIMPLE,
        autoDisplay: false
      },
      'google_translate_element'
    );
  }
</script>
<script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<!-- 翻译按钮样式 - 简化样式避免冲突 -->
<style>
  .my-language-switch {
    position: fixed;
    right: 20px;
    top: 70px;
    z-index: 9999;
  }
  
  .my-translate-button {
    background-color: #4285f4;
    color: white;
    border: none;
    border-radius: 4px;
    padding: 5px 10px;
    cursor: pointer;
    font-size: 14px;
    margin-left: 5px;
  }
  
  /* 隐藏Google翻译工具栏 */
  .goog-te-banner-frame {
    display: none !important;
  }
  
  /* 修复顶部位移问题 */
  body {
    top: 0 !important;
  }
  
  .skiptranslate {
    display: none !important;
  }
</style>

<!-- 翻译控件和按钮 -->
<div id="google_translate_element" style="display:none;"></div>

<div class="my-language-switch">
  <button class="my-translate-button" onclick="changeLanguage('zh-CN')">中文</button>
  <button class="my-translate-button" onclick="changeLanguage('en')">English</button>
</div>

<!-- 翻译功能脚本 -->
<script>
  function changeLanguage(langCode) {
    var select = document.querySelector('.goog-te-combo');
    if (select) {
      select.value = langCode;
      select.dispatchEvent(new Event('change'));
      localStorage.setItem('preferredLanguage', langCode);
    }
  }
  
  // 页面加载时应用上次选择的语言
  document.addEventListener('DOMContentLoaded', function() {
    var savedLang = localStorage.getItem('preferredLanguage');
    if (savedLang && savedLang !== 'zh-CN') {
      setTimeout(function() {
        changeLanguage(savedLang);
      }, 1000);
    }
  });
</script>
